#Must be BASE64 encoded
pdns_api_key: {{ services.coreServices.dns.externaldns.powerdnsApiKey | b64encode }}

external-dns:
  pdns:
    apiUrl: "{{ services.coreServices.dns.externaldns.apiUrl}}"
    apiPort: "{{ services.coreServices.dns.externaldns.apiPort }}"
    secretName: "external-dns"

  image:
    registry: {{ services.coreServices.dns.externaldns.imageRegistry }}

  provider: pdns

  extraVolumeMounts:
    - name: certs
      mountPath: "/etc/ssl/certs/corp-ca.pem"
      subPath: "corp-ca.pem"

  extraVolumes:
    - name: certs
      configMap:
        name: {{ services.coreServices.dns.externaldns.corporateCertificateConfigmapName }}

  extraArgs:
    pdns-tls-enabled: false
    tls-ca: /etc/ssl/certs/corp-ca.pem

  domainFilters:
    {%- for filter in services.coreServices.dns.externaldns.domainFilter %}
    - {{ filter.uri }}
    {%- endfor %}
  txtOwnerId: "{{ services.coreServices.dns.externaldns.txtOwnerID }}"
